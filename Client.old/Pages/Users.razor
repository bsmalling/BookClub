@page "/users"
@using Microsoft.AspNetCore.Authorization
@attribute [Authorize]
@using BookClub.Models
@inject BookClubRestClient bookClubRestClient

<h1>Users</h1>

<table>
    <tr>
        <th>Last</th>
        <th>First</th>
        <th>Username</th>
        <th>Email</th>
        <th>Role</th>
    </tr>
    @foreach (var user in users)
    {
        <tr>
            <td>
                @user.LastName
            </td>
            <td>
                @user.FirstName
            </td>
            <td>
                @user.Username
            </td>
            <td>
                @user.Email
            </td>
            <td>
                @user.Role
            </td>
        </tr>
    }
</table>

@code {
    private IList<User> users = null;

    protected override void OnInitialized()
    {
        users = Task.Run(() => bookClubRestClient.GetListAsync<User>(BookClubRestClient.UserRoute)).Result;
    }
}
